@{
    ViewData["Title"] = "Internal Server Error - 500";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<!-- Hero Section -->
<section class="error-hero-section text-white py-5">
    <div class="container">
        <div class="row align-items-center min-vh-75">
            <div class="col-lg-6">
                <div class="error-content">
                    <h1 class="error-code display-1 fw-bold mb-4">500</h1>
                    <h2 class="error-title display-5 fw-bold mb-3">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        Something Went Wrong
                    </h2>
                    <p class="error-description lead mb-4">
                        We're experiencing some technical difficulties on our family tree servers. 
                        Our team has been notified and we're working to restore everything quickly.
                    </p>
                    
                    <!-- Status Information -->
                    <div class="status-info mb-4">
                        <div class="card bg-dark bg-opacity-25 border-0">
                            <div class="card-body">
                                <div class="row g-3 text-center">
                                    <div class="col-md-4">
                                        <div class="status-item">
                                            <i class="fas fa-server fa-2x mb-2 text-warning"></i>
                                            <div>Server Status</div>
                                            <small class="text-warning">Investigating</small>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="status-item">
                                            <i class="fas fa-database fa-2x mb-2 text-success"></i>
                                            <div>Database</div>
                                            <small class="text-success">Online</small>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <div class="status-item">
                                            <i class="fas fa-shield-alt fa-2x mb-2 text-success"></i>
                                            <div>Data Security</div>
                                            <small class="text-success">Protected</small>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Action Buttons -->
                    <div class="error-actions d-flex flex-wrap gap-3">
                        <button type="button" class="btn btn-light btn-lg" onclick="retryPage()">
                            <i class="fas fa-redo me-2"></i>Try Again
                        </button>
                        <a href="/" class="btn btn-outline-light btn-lg">
                            <i class="fas fa-home me-2"></i>Go Home
                        </a>
                        <button type="button" class="btn btn-outline-light btn-lg" onclick="reportError()">
                            <i class="fas fa-bug me-2"></i>Report Error
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-lg-6 text-center">
                <!-- Animated Server Illustration -->
                <div class="error-illustration">
                    <div class="server-stack">
                        <div class="server-unit server-1">
                            <i class="fas fa-server fa-4x"></i>
                            <div class="server-lights">
                                <div class="light red"></div>
                                <div class="light yellow"></div>
                                <div class="light green"></div>
                            </div>
                        </div>
                        <div class="server-unit server-2">
                            <i class="fas fa-server fa-4x"></i>
                            <div class="server-lights">
                                <div class="light red blinking"></div>
                                <div class="light yellow"></div>
                                <div class="light green"></div>
                            </div>
                        </div>
                        <div class="server-unit server-3">
                            <i class="fas fa-server fa-4x"></i>
                            <div class="server-lights">
                                <div class="light red"></div>
                                <div class="light yellow blinking"></div>
                                <div class="light green"></div>
                            </div>
                        </div>
                        <div class="error-sparks">
                            <i class="fas fa-bolt spark spark-1"></i>
                            <i class="fas fa-bolt spark spark-2"></i>
                            <i class="fas fa-bolt spark spark-3"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- What You Can Do Section -->
<section class="py-5 bg-light">
    <div class="container">
        <div class="row">
            <div class="col-12 text-center mb-4">
                <h3>What you can do while we fix this</h3>
                <p class="text-muted">Your family data is safe and secure</p>
            </div>
        </div>
        <div class="row g-4">
            <div class="col-md-6 col-lg-3">
                <div class="card border-0 shadow-sm h-100 suggestion-card">
                    <div class="card-body text-center p-4">
                        <i class="fas fa-clock fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Wait a Moment</h5>
                        <p class="card-text text-muted">Issues are usually resolved within 5-10 minutes</p>
                        <div class="countdown-timer" id="retryCountdown">
                            Auto-retry in: <span class="fw-bold">60s</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card border-0 shadow-sm h-100 suggestion-card">
                    <div class="card-body text-center p-4">
                        <i class="fas fa-mobile-alt fa-3x text-success mb-3"></i>
                        <h5 class="card-title">Try Mobile App</h5>
                        <p class="card-text text-muted">Access your family tree on mobile</p>
                        <a href="#" class="btn btn-outline-success">Download App</a>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card border-0 shadow-sm h-100 suggestion-card">
                    <div class="card-body text-center p-4">
                        <i class="fas fa-comments fa-3x text-warning mb-3"></i>
                        <h5 class="card-title">Community</h5>
                        <p class="card-text text-muted">Connect with other genealogy enthusiasts</p>
                        <a href="#" class="btn btn-outline-warning">Join Community</a>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3">
                <div class="card border-0 shadow-sm h-100 suggestion-card">
                    <div class="card-body text-center p-4">
                        <i class="fas fa-book fa-3x text-info mb-3"></i>
                        <h5 class="card-title">Learn More</h5>
                        <p class="card-text text-muted">Read our genealogy guides and tips</p>
                        <a href="/help" class="btn btn-outline-info">Help Center</a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Technical Details (Development Only) -->
@if (Context.RequestServices.GetService<IWebHostEnvironment>()?.IsDevelopment() == true)
{
    <section class="py-4 bg-danger text-white">
        <div class="container">
            <div class="alert alert-danger border-0">
                <h5 class="alert-heading text-white">
                    <i class="fas fa-bug me-2"></i>
                    Development Error Information
                </h5>
                <hr class="text-white">
                <div class="row">
                    <div class="col-md-6">
                        <p class="mb-2"><strong>Timestamp:</strong> @DateTime.UtcNow.ToString("yyyy-MM-dd HH:mm:ss") UTC</p>
                        <p class="mb-2"><strong>Request ID:</strong> @System.Diagnostics.Activity.Current?.Id ?? "N/A"</p>
                        <p class="mb-2"><strong>URL:</strong> @Context.Request.Path@Context.Request.QueryString</p>
                    </div>
                    <div class="col-md-6">
                        <p class="mb-2"><strong>Method:</strong> @Context.Request.Method</p>
                        <p class="mb-2"><strong>User:</strong> @(User.Identity?.Name ?? "Anonymous")</p>
                        <p class="mb-2"><strong>User Agent:</strong> @Context.Request.Headers.UserAgent.ToString().Substring(0, Math.Min(50, Context.Request.Headers.UserAgent.ToString().Length))...</p>
                    </div>
                </div>
                <div class="mt-3">
                    <button type="button" class="btn btn-outline-light btn-sm" onclick="copyErrorDetails()">
                        <i class="fas fa-copy me-1"></i>Copy Error Details
                    </button>
                </div>
            </div>
        </div>
    </section>
}

<!-- Support Section -->
<section class="py-5">
    <div class="container">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card border-0 shadow-sm">
                    <div class="card-body p-5 text-center">
                        <i class="fas fa-life-ring fa-3x text-primary mb-3"></i>
                        <h4>Need Immediate Help?</h4>
                        <p class="text-muted mb-4">
                            If this error persists, our support team is standing by to assist you.
                        </p>
                        
                        <!-- Error Reporting Form -->
                        <div class="row g-3 mb-4">
                            <div class="col-md-6">
                                <input type="email" class="form-control" placeholder="Your email address" id="errorReportEmail">
                            </div>
                            <div class="col-md-6">
                                <button type="button" class="btn btn-primary w-100" onclick="sendErrorReport()">
                                    <i class="fas fa-paper-plane me-2"></i>Get Notified When Fixed
                                </button>
                            </div>
                        </div>
                        
                        <div class="row g-3">
                            <div class="col-md-4">
                                <a href="/contact" class="btn btn-outline-primary w-100">
                                    <i class="fas fa-envelope me-2"></i>Contact Support
                                </a>
                            </div>
                            <div class="col-md-4">
                                <a href="tel:+15551234567" class="btn btn-outline-success w-100">
                                    <i class="fas fa-phone me-2"></i>Call Support
                                </a>
                            </div>
                            <div class="col-md-4">
                                <a href="#" class="btn btn-outline-info w-100" onclick="openLiveChat()">
                                    <i class="fas fa-comments me-2"></i>Live Chat
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
       
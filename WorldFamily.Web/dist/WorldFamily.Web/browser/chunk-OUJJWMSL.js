import{a as z}from"./chunk-CP6XCTAL.js";import{a as V}from"./chunk-IVNTOVZQ.js";import{a as U}from"./chunk-CQXCCY24.js";import{a as $}from"./chunk-SLFAL3KE.js";import{d as k,e as A,h as R,i as T,k as N,t as L,w as j}from"./chunk-Q7HNEB5Z.js";import{$b as v,Gb as I,Kb as O,Lb as d,O as x,Ra as o,Wa as f,Xb as B,Zb as a,_b as s,ac as P,bb as C,bc as F,ca as S,da as M,f as D,gb as c,hc as h,ic as _,jc as b,kc as w,lc as y,t as E,wb as u,xb as t,yb as r,zb as m}from"./chunk-AKCSPO7I.js";import"./chunk-4CLCTAJ7.js";var J=()=>["/families"],Y=n=>["/families",n],K=()=>["/members"];function q(n,i){n&1&&(t(0,"div",4)(1,"div",5)(2,"span",6),a(3,"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435..."),r()(),t(4,"p",7),a(5,"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435 \u043D\u0430 \u0434\u0435\u0442\u0430\u0439\u043B\u0438..."),r()())}function H(n,i){if(n&1){let e=I();t(0,"div",8),m(1,"i",9),t(2,"h4"),a(3,"\u0413\u0440\u0435\u0448\u043A\u0430"),r(),t(4,"p"),a(5),r(),t(6,"button",10),O("click",function(){S(e);let p=d();return M(p.loadMemberData())}),m(7,"i",11),a(8,"\u041E\u043F\u0438\u0442\u0430\u0439\u0442\u0435 \u043E\u0442\u043D\u043E\u0432\u043E "),r()()}if(n&2){let e=d();o(5),s(e.error)}}function Q(n,i){if(n&1&&(t(0,"div",35)(1,"div",36),m(2,"i",49),t(3,"span",38),a(4,"\u0420\u043E\u0436\u0434\u0435\u043D:"),r(),t(5,"span",39),a(6),b(7,"date"),r()()()),n&2){let e=d(2);o(6),s(y(7,1,e.member.dateOfBirth,"dd.MM.yyyy"))}}function W(n,i){if(n&1&&(t(0,"div",35)(1,"div",36),m(2,"i",50),t(3,"span",38),a(4,"\u0412\u044A\u0437\u0440\u0430\u0441\u0442:"),r(),t(5,"span",39),a(6),r()()()),n&2){let e=d(2);o(6),v("",e.getAge(e.member.dateOfBirth)," \u0433\u043E\u0434\u0438\u043D\u0438")}}function X(n,i){if(n&1&&(t(0,"div",35)(1,"div",36),m(2,"i",51),t(3,"span",38),a(4,"\u041C\u044F\u0441\u0442\u043E \u043D\u0430 \u0440\u0430\u0436\u0434\u0430\u043D\u0435:"),r(),t(5,"span",39),a(6),r()()()),n&2){let e=d(2);o(6),s(e.member.placeOfBirth)}}function Z(n,i){if(n&1&&(t(0,"div",35)(1,"div",36),m(2,"i",52),t(3,"span",38),a(4,"\u041F\u043E\u0447\u0438\u043D\u0430\u043B:"),r(),t(5,"span",39),a(6),b(7,"date"),r()()()),n&2){let e=d(2);o(6),s(y(7,1,e.member.dateOfDeath,"dd.MM.yyyy"))}}function ee(n,i){if(n&1&&(t(0,"div",35)(1,"div",36),m(2,"i",53),t(3,"span",38),a(4,"\u041C\u044F\u0441\u0442\u043E \u043D\u0430 \u0441\u043C\u044A\u0440\u0442:"),r(),t(5,"span",39),a(6),r()()()),n&2){let e=d(2);o(6),s(e.member.placeOfDeath)}}function te(n,i){if(n&1&&(t(0,"div",58)(1,"div",59),m(2,"i",46),t(3,"strong"),a(4),r()(),t(5,"div",60),a(6),r()()),n&2){let e=i.$implicit;o(4),s(e.key),o(2),v(" ",e.value.join(", ")," ")}}function ie(n,i){if(n&1&&(t(0,"div",13)(1,"h4",32),m(2,"i",55),a(3,"\u0420\u043E\u0434\u043D\u0438\u043D\u0441\u043A\u0438 \u0432\u0440\u044A\u0437\u043A\u0438 "),r(),t(4,"div",56),c(5,te,7,2,"div",57),r()()),n&2){let e=d().$implicit;o(5),u("ngForOf",e)}}function ne(n,i){if(n&1&&(t(0,"div",31),c(1,ie,6,1,"div",54),r()),n&2){let e=i.$implicit;o(),u("ngIf",e.length>0)}}function re(n,i){n&1&&(t(0,"div",31)(1,"div",13)(2,"h4",32),m(3,"i",55),a(4,"\u0420\u043E\u0434\u043D\u0438\u043D\u0441\u043A\u0438 \u0432\u0440\u044A\u0437\u043A\u0438 "),r(),t(5,"div",61),m(6,"i",62),t(7,"div")(8,"strong"),a(9,"\u041D\u044F\u043C\u0430 \u0437\u0430\u043F\u0438\u0441\u0430\u043D\u0438 \u0432\u0440\u044A\u0437\u043A\u0438"),r(),t(10,"p",63),a(11,"\u0420\u043E\u0434\u043D\u0438\u043D\u0441\u043A\u0438\u0442\u0435 \u0432\u0440\u044A\u0437\u043A\u0438 \u043C\u043E\u0433\u0430\u0442 \u0434\u0430 \u0431\u044A\u0434\u0430\u0442 \u0434\u043E\u0431\u0430\u0432\u0435\u043D\u0438 \u043E\u0442 \u0447\u043B\u0435\u043D\u043E\u0432\u0435 \u043D\u0430 \u0441\u0435\u043C\u0435\u0439\u0441\u0442\u0432\u043E\u0442\u043E."),r()()()()())}function ae(n,i){if(n&1&&(t(0,"div",12)(1,"div",13)(2,"h4",32),m(3,"i",64),a(4,"\u0411\u0438\u043E\u0433\u0440\u0430\u0444\u0438\u044F "),r(),t(5,"div",65)(6,"p",66),a(7),r()()()()),n&2){let e=d(2);o(7),s(e.member.biography)}}function oe(n,i){if(n&1&&(t(0,"div")(1,"div",12)(2,"div",13)(3,"nav",14)(4,"ol",15)(5,"li",16)(6,"a",17),m(7,"i",18),a(8,"\u0421\u0435\u043C\u0435\u0439\u0441\u0442\u0432\u0430 "),r()(),t(9,"li",16)(10,"a",17),a(11),r()(),t(12,"li",19),a(13),r()()()()(),t(14,"div",20)(15,"div",21)(16,"div",22)(17,"div",23)(18,"div",24)(19,"div",25),m(20,"i",26),r(),t(21,"div")(22,"h2",27),a(23),r(),t(24,"p",28),m(25,"i",29),a(26),r()()()(),t(27,"div",30)(28,"div",31)(29,"div",13)(30,"h4",32),m(31,"i",33),a(32,"\u041E\u0441\u043D\u043E\u0432\u043D\u0430 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F "),r(),t(33,"div",34)(34,"div",35)(35,"div",36),m(36,"i",37),t(37,"span",38),a(38,"\u041F\u043E\u043B:"),r(),t(39,"span",39),a(40),r()()(),c(41,Q,8,4,"div",40)(42,W,7,1,"div",40)(43,X,7,1,"div",40)(44,Z,8,4,"div",40)(45,ee,7,1,"div",40),r()()(),c(46,ne,2,1,"div",41),b(47,"keyvalue"),c(48,re,12,0,"div",41)(49,ae,8,1,"div",42),r(),t(50,"div",43)(51,"div",44)(52,"a",45),m(53,"i",46),a(54,"\u0412\u0438\u0436 \u0441\u0435\u043C\u0435\u0439\u0441\u0442\u0432\u043E\u0442\u043E "),r(),t(55,"a",47),m(56,"i",48),a(57,"\u0412\u0441\u0438\u0447\u043A\u0438 \u0440\u043E\u0434\u043D\u0438\u043D\u0438 "),r()()()()()()()),n&2){let e=d();o(6),u("routerLink",h(26,J)),o(4),u("routerLink",_(27,Y,e.member.familyId)),o(),v(" ",e.family.name," "),o(2),P(" ",e.member.firstName," ",e.member.lastName," "),o(7),B("fa-mars",e.member.gender==="Male")("fa-venus",e.member.gender==="Female"),o(3),F(" ",e.member.firstName," ",e.member.middleName," ",e.member.lastName," "),o(3),v(" \u0427\u043B\u0435\u043D \u043D\u0430 ",e.family.name," "),o(14),s(e.member.gender==="Male"?"\u041C\u044A\u0436":"\u0416\u0435\u043D\u0430"),o(),u("ngIf",e.member.dateOfBirth&&e.canViewPersonalData()),o(),u("ngIf",e.member.dateOfBirth&&e.canViewPersonalData()),o(),u("ngIf",e.member.placeOfBirth),o(),u("ngIf",e.member.dateOfDeath),o(),u("ngIf",e.member.placeOfDeath),o(),u("ngIf",w(47,24,e.getGroupedRelationships())),o(2),u("ngIf",e.relationships.length===0),o(),u("ngIf",e.member.biography),o(3),u("routerLink",_(29,Y,e.member.familyId)),o(3),u("routerLink",h(31,K))}}var G=class n{constructor(i,e,l,p,g){this.route=i;this.memberService=e;this.familyService=l;this.relationshipService=p;this.authService=g}destroy$=new D;member=null;family=null;relationships=[];isLoading=!0;error=null;memberId=0;ngOnInit(){this.route.params.pipe(x(this.destroy$)).subscribe(i=>{this.memberId=+i.id,this.memberId?this.loadMemberData():(this.error="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0438\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u043E\u0440 \u043D\u0430 \u0447\u043B\u0435\u043D",this.isLoading=!1)})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadMemberData(){this.isLoading=!0,this.error=null,this.memberService.getMemberById(this.memberId).pipe(x(this.destroy$)).subscribe({next:i=>{this.member=i,E({family:this.familyService.getFamilyById(i.familyId),relationships:this.relationshipService.getRelationshipsByMember(i.id)}).subscribe({next:e=>{this.family=e.family,this.relationships=e.relationships,this.isLoading=!1},error:e=>{console.error("Error loading additional data:",e),this.isLoading=!1}})},error:i=>{this.isLoading=!1,this.error="\u0427\u043B\u0435\u043D\u044A\u0442 \u043D\u0435 \u0435 \u043D\u0430\u043C\u0435\u0440\u0435\u043D \u0438\u043B\u0438 \u0432\u044A\u0437\u043D\u0438\u043A\u043D\u0430 \u0433\u0440\u0435\u0448\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435\u0442\u043E.",console.error("Error loading member:",i)}})}canViewPersonalData(){return this.family?this.authService.getCurrentUser()?.id===this.family.createdByUserId:!1}getAge(i){let e=new Date,l=new Date(i),p=e.getFullYear()-l.getFullYear(),g=e.getMonth()-l.getMonth();return(g<0||g===0&&e.getDate()<l.getDate())&&p--,p}getGroupedRelationships(){let i={};return this.relationships.forEach(e=>{let l=this.getRelationshipTypeForMember(e),p=this.getRelatedPersonName(e);l&&p&&(i[l]||(i[l]=[]),i[l].push(p))}),i}getRelationshipTypeForMember(i){let e={1:"\u0420\u043E\u0434\u0438\u0442\u0435\u043B \u043D\u0430",2:"\u0414\u0435\u0442\u0435 \u043D\u0430",3:"\u0421\u044A\u043F\u0440\u0443\u0433/\u0430 \u043D\u0430",4:"\u0411\u0440\u0430\u0442/\u0421\u0435\u0441\u0442\u0440\u0430 \u043D\u0430",5:"\u0411\u0430\u0431\u0430/\u0414\u044F\u0434\u043E \u043D\u0430",6:"\u0412\u043D\u0443\u043A/\u0412\u043D\u0443\u0447\u043A\u0430 \u043D\u0430",7:"\u0427\u0438\u0447\u043E/\u0412\u0443\u0439\u0447\u043E \u043D\u0430",8:"\u041B\u0435\u043B\u044F \u043D\u0430",9:"\u041F\u043B\u0435\u043C\u0435\u043D\u043D\u0438\u043A \u043D\u0430",10:"\u041F\u043B\u0435\u043C\u0435\u043D\u043D\u0438\u0446\u0430 \u043D\u0430",11:"\u0411\u0440\u0430\u0442\u043E\u0432\u0447\u0435\u0434/\u043A\u0430 \u043D\u0430",12:"\u041F\u0440\u0430\u0431\u0430\u0431\u0430/\u041F\u0440\u0430\u0434\u044F\u0434\u043E \u043D\u0430",13:"\u041F\u0440\u0430\u0432\u043D\u0443\u043A/\u043A\u0430 \u043D\u0430",14:"\u0414\u043E\u0432\u0435\u0434\u0435\u043D \u0440\u043E\u0434\u0438\u0442\u0435\u043B \u043D\u0430",15:"\u0414\u043E\u0432\u0435\u0434\u0435\u043D\u043E \u0434\u0435\u0442\u0435 \u043D\u0430",16:"\u0414\u043E\u0432\u0435\u0434\u0435\u043D \u0431\u0440\u0430\u0442/\u0441\u0435\u0441\u0442\u0440\u0430 \u043D\u0430",17:"\u041F\u043E\u043B\u0443\u0431\u0440\u0430\u0442/\u0441\u0435\u0441\u0442\u0440\u0430 \u043D\u0430",99:"\u0414\u0440\u0443\u0433\u043E"};return i.primaryMemberId===this.memberId?e[i.relationshipType]||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u0430 \u0432\u0440\u044A\u0437\u043A\u0430":this.getReverseRelationshipName(i.relationshipType)}getReverseRelationshipName(i){return{1:"\u0414\u0435\u0442\u0435 \u043D\u0430",2:"\u0420\u043E\u0434\u0438\u0442\u0435\u043B \u043D\u0430",3:"\u0421\u044A\u043F\u0440\u0443\u0433/\u0430 \u043D\u0430",4:"\u0411\u0440\u0430\u0442/\u0421\u0435\u0441\u0442\u0440\u0430 \u043D\u0430",5:"\u0412\u043D\u0443\u043A/\u0412\u043D\u0443\u0447\u043A\u0430 \u043D\u0430",6:"\u0411\u0430\u0431\u0430/\u0414\u044F\u0434\u043E \u043D\u0430",7:"\u041F\u043B\u0435\u043C\u0435\u043D\u043D\u0438\u043A/\u0446\u0430 \u043D\u0430",8:"\u041F\u043B\u0435\u043C\u0435\u043D\u043D\u0438\u043A/\u0446\u0430 \u043D\u0430",9:"\u0427\u0438\u0447\u043E/\u0412\u0443\u0439\u0447\u043E \u043D\u0430",10:"\u041B\u0435\u043B\u044F \u043D\u0430",11:"\u0411\u0440\u0430\u0442\u043E\u0432\u0447\u0435\u0434/\u043A\u0430 \u043D\u0430",12:"\u041F\u0440\u0430\u0432\u043D\u0443\u043A/\u043A\u0430 \u043D\u0430",13:"\u041F\u0440\u0430\u0431\u0430\u0431\u0430/\u041F\u0440\u0430\u0434\u044F\u0434\u043E \u043D\u0430",14:"\u0414\u043E\u0432\u0435\u0434\u0435\u043D\u043E \u0434\u0435\u0442\u0435 \u043D\u0430",15:"\u0414\u043E\u0432\u0435\u0434\u0435\u043D \u0440\u043E\u0434\u0438\u0442\u0435\u043B \u043D\u0430",16:"\u0414\u043E\u0432\u0435\u0434\u0435\u043D \u0431\u0440\u0430\u0442/\u0441\u0435\u0441\u0442\u0440\u0430 \u043D\u0430",17:"\u041F\u043E\u043B\u0443\u0431\u0440\u0430\u0442/\u0441\u0435\u0441\u0442\u0440\u0430 \u043D\u0430",99:"\u0414\u0440\u0443\u0433\u043E"}[i]||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u0430 \u0432\u0440\u044A\u0437\u043A\u0430"}getRelatedPersonName(i){return i.primaryMemberId===this.memberId?i.relatedMemberName||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u0435\u043D":i.primaryMemberName||"\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u0435\u043D"}static \u0275fac=function(e){return new(e||n)(f(L),f(U),f(V),f(z),f($))};static \u0275cmp=C({type:n,selectors:[["app-member-details-bootstrap"]],decls:4,vars:3,consts:[[1,"container","mt-4"],["class","text-center py-5",4,"ngIf"],["class","alert alert-danger text-center",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary",2,"width","3rem","height","3rem"],[1,"visually-hidden"],[1,"mt-3","text-muted"],[1,"alert","alert-danger","text-center"],[1,"fas","fa-exclamation-triangle","fa-2x","mb-3"],[1,"btn","btn-outline-danger",3,"click"],[1,"fas","fa-redo","me-1"],[1,"row","mb-4"],[1,"col-12"],["aria-label","breadcrumb"],[1,"breadcrumb"],[1,"breadcrumb-item"],[1,"text-decoration-none",3,"routerLink"],[1,"fas","fa-home","me-1"],["aria-current","page",1,"breadcrumb-item","active"],[1,"row"],[1,"col-lg-8","mx-auto"],[1,"card","border-0","shadow-lg"],[1,"card-header","bg-primary","text-white","text-center","py-4"],[1,"d-flex","align-items-center","justify-content-center","mb-3"],[1,"avatar-circle","me-3"],[1,"fas"],[1,"card-title","mb-1"],[1,"card-subtitle","mb-0","opacity-75"],[1,"fas","fa-users","me-1"],[1,"card-body","p-5"],[1,"row","mb-5"],[1,"text-primary","mb-4"],[1,"fas","fa-info-circle","me-2"],[1,"row","g-3"],[1,"col-md-6"],[1,"info-item"],[1,"fas","fa-venus-mars","text-muted","me-2"],[1,"label"],[1,"value"],["class","col-md-6",4,"ngIf"],["class","row mb-5",4,"ngIf"],["class","row mb-4",4,"ngIf"],[1,"card-footer","bg-light","text-center","py-4"],[1,"d-flex","gap-3","justify-content-center","flex-wrap"],[1,"btn","btn-outline-primary",3,"routerLink"],[1,"fas","fa-users","me-2"],[1,"btn","btn-outline-secondary",3,"routerLink"],[1,"fas","fa-arrow-left","me-2"],[1,"fas","fa-birthday-cake","text-warning","me-2"],[1,"fas","fa-calendar-alt","text-info","me-2"],[1,"fas","fa-map-marker-alt","text-danger","me-2"],[1,"fas","fa-cross","text-dark","me-2"],[1,"fas","fa-map-marker-alt","text-dark","me-2"],["class","col-12",4,"ngIf"],[1,"fas","fa-sitemap","me-2"],[1,"relationships-container"],["class","relationship-item mb-3",4,"ngFor","ngForOf"],[1,"relationship-item","mb-3"],[1,"relationship-header"],[1,"relationship-names"],[1,"alert","alert-info","d-flex","align-items-center"],[1,"fas","fa-info-circle","me-3"],[1,"mb-0","mt-1"],[1,"fas","fa-book","me-2"],[1,"biography-section"],[1,"biography-text"]],template:function(e,l){e&1&&(t(0,"div",0),c(1,q,6,0,"div",1)(2,H,9,1,"div",2)(3,oe,58,32,"div",3),r()),e&2&&(o(),u("ngIf",l.isLoading),o(),u("ngIf",l.error),o(),u("ngIf",l.member&&l.family&&!l.isLoading&&!l.error))},dependencies:[N,k,A,j,R,T],styles:['.card[_ngcontent-%COMP%]{border-radius:1rem;overflow:hidden}.card-header[_ngcontent-%COMP%]{border-radius:1rem 1rem 0 0!important}.avatar-circle[_ngcontent-%COMP%]{width:60px;height:60px;background:#fff3;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1.5rem}.info-item[_ngcontent-%COMP%]{background:#f8f9fa;padding:.75rem 1rem;border-radius:.5rem;border-left:4px solid #0d6efd;display:flex;align-items:center;gap:.5rem;height:100%}.label[_ngcontent-%COMP%]{font-weight:600;color:#495057;min-width:100px}.value[_ngcontent-%COMP%]{color:#6c757d;font-weight:500}.relationships-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.relationship-item[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #e9ecef;border-radius:.75rem;padding:1rem 1.25rem;border-left:4px solid #28a745}.relationship-header[_ngcontent-%COMP%]{display:flex;align-items:center;color:#495057;font-size:1rem;margin-bottom:.5rem}.relationship-names[_ngcontent-%COMP%]{color:#6c757d;font-size:.95rem;line-height:1.4;padding-left:1.75rem}.biography-section[_ngcontent-%COMP%]{background:#f8f9fa;padding:1.5rem;border-radius:.75rem;border-left:4px solid #6c757d}.biography-text[_ngcontent-%COMP%]{line-height:1.6;color:#495057;margin:0;font-size:1.1rem}.breadcrumb[_ngcontent-%COMP%]{background:transparent;padding:0;margin:0}.breadcrumb-item[_ngcontent-%COMP%] + .breadcrumb-item[_ngcontent-%COMP%]:before{content:">";color:#6c757d}.btn[_ngcontent-%COMP%]{border-radius:.5rem;font-weight:500;transition:all .3s ease}.btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:0 15px}.card-body[_ngcontent-%COMP%]{padding:2rem!important}.info-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;text-align:left}.label[_ngcontent-%COMP%]{min-width:auto;margin-bottom:.25rem}.d-flex.gap-3[_ngcontent-%COMP%]{flex-direction:column}}']})};export{G as MemberDetailsBootstrapComponent};

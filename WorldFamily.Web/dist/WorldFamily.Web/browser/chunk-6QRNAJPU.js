import{a as re}from"./chunk-IL55YHCJ.js";import{a as te}from"./chunk-CRNNILGP.js";import{a as ie}from"./chunk-DMFGUMIH.js";import{a as ne}from"./chunk-5V7HPQDU.js";import{a as ee}from"./chunk-GVQVI2L6.js";import{d as J,e as F,h as K,k as w,v as Q,x as X,y as Z}from"./chunk-PT5BEB6V.js";import{$b as C,Ab as u,Hb as M,Lb as y,Mb as d,O as S,Qa as O,Sa as m,Wb as G,Xa as D,Yb as _,_b as o,ac as g,bc as T,ca as x,cb as E,da as h,f as z,fb as P,hb as f,jb as Y,jc as W,kc as I,lc as k,nc as q,oc as U,pc as H,sb as R,xb as s,yb as n,zb as a}from"./chunk-AAMWR3CC.js";import"./chunk-4CLCTAJ7.js";var A=class t{transform(i,e,r,l=!0){if(!i)return"";let c=[i.trim()];return l&&e&&e.trim()&&c.push(e.trim()),r&&r.trim()&&c.push(r.trim()),c.join(" ")}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=P({name:"fullName",type:t,pure:!0})};var V=class t{transform(i,e,r="text"){if(!i)return"";let l=new Date(i),c=e?new Date(e):new Date,p=c.getFullYear()-l.getFullYear(),b=c.getMonth()-l.getMonth();switch((b<0||b===0&&c.getDate()<l.getDate())&&p--,r){case"number":return p;case"detailed":let v=b<0?b+12:b,L=c.getDate()-l.getDate();if(p<1)return v<1?`${Math.abs(L)} ${Math.abs(L)===1?"\u0434\u0435\u043D":"\u0434\u043D\u0438"}`:`${v} ${v===1?"\u043C\u0435\u0441\u0435\u0446":"\u043C\u0435\u0441\u0435\u0446\u0430"}`;let j=`${p} ${p===1?"\u0433\u043E\u0434\u0438\u043D\u0430":"\u0433\u043E\u0434\u0438\u043D\u0438"}`;return v>0&&(j+=` \u0438 ${v} ${v===1?"\u043C\u0435\u0441ec":"\u043C\u0435\u0441\u0435\u0446\u0430"}`),j;default:return p<1?"\u043F\u043E\u0434 1 \u0433\u043E\u0434\u0438\u043D\u0430":p===1?"1 \u0433\u043E\u0434\u0438\u043D\u0430":`${p} \u0433\u043E\u0434\u0438\u043D\u0438`}}static \u0275fac=function(e){return new(e||t)};static \u0275pipe=P({name:"memberAge",type:t,pure:!0})};function le(t,i){if(t&1&&u(0,"img",29),t&2){let e=d(2);s("src",e.member.profileImageUrl,O)("alt",e.member.firstName+" "+e.member.lastName)}}function de(t,i){if(t&1&&(n(0,"div",30),u(1,"i",31),a()),t&2){let e=d(2);_("male-avatar",e.member.gender==="Male")("female-avatar",e.member.gender==="Female"),m(),_("fa-mars",e.member.gender==="Male")("fa-venus",e.member.gender==="Female")}}function se(t,i){if(t&1&&(n(0,"div",32)(1,"div",33),u(2,"i",34),n(3,"span",35),o(4,"\u0420\u043E\u0436\u0434\u0435\u043D\u0430 \u0434\u0430\u0442\u0430:"),a(),n(5,"span",36),o(6),I(7,"date"),n(8,"span",37),o(9),I(10,"memberAge"),a()()()()),t&2){let e=d(2);m(6),g(" ",U(7,2,e.member.dateOfBirth,"dd MMMM yyyy","","bg")," "),m(3),g("(",k(10,7,e.member.dateOfBirth),")")}}function ue(t,i){if(t&1&&(n(0,"div",32)(1,"div",33),u(2,"i",38),n(3,"span",35),o(4,"\u0414\u0430\u0442\u0430 \u043D\u0430 \u0441\u043C\u044A\u0440\u0442:"),a(),n(5,"span",36),o(6),I(7,"date"),a()()()),t&2){let e=d(2);m(6),C(U(7,1,e.member.dateOfDeath,"dd MMMM yyyy","","bg"))}}function ce(t,i){if(t&1&&(n(0,"div",32)(1,"div",33),u(2,"i",39),n(3,"span",35),o(4,"\u041C\u044F\u0441\u0442\u043E \u043D\u0430 \u0440\u0430\u0436\u0434\u0430\u043D\u0435:"),a(),n(5,"span",36),o(6),a()()()),t&2){let e=d(2);m(6),C(e.member.placeOfBirth)}}function pe(t,i){if(t&1&&(n(0,"div",32)(1,"div",33),u(2,"i",40),n(3,"span",35),o(4,"\u041C\u044F\u0441\u0442\u043E \u043D\u0430 \u0441\u043C\u044A\u0440\u0442:"),a(),n(5,"span",36),o(6),a()()()),t&2){let e=d(2);m(6),C(e.member.placeOfDeath)}}function fe(t,i){if(t&1&&(n(0,"div",41)(1,"h6",21),u(2,"i",42),o(3," \u0411\u0438\u043E\u0433\u0440\u0430\u0444\u0438\u044F "),a(),n(4,"div",43),o(5),a()()),t&2){let e=d(2);m(5),g(" ",e.member.biography," ")}}function ge(t,i){if(t&1){let e=M();n(0,"div",2),y("click",function(l){x(e);let c=d();return h(c.onBackdropClick(l))}),n(1,"div",3)(2,"div",4),y("click",function(l){return x(e),h(l.stopPropagation())}),n(3,"div",5)(4,"h5",6),u(5,"i",7),o(6),I(7,"fullName"),a(),n(8,"button",8),y("click",function(){x(e);let l=d();return h(l.closeModal())}),a()(),n(9,"div",9)(10,"div",10)(11,"div",11)(12,"div",12),f(13,le,1,2,"img",13)(14,de,2,8,"div",14),a(),n(15,"div",15)(16,"span",16),u(17,"i",17),o(18),a()()(),n(19,"div",18)(20,"div",19)(21,"div",20)(22,"h6",21),u(23,"i",22),o(24," \u041E\u0441\u043D\u043E\u0432\u043D\u0430 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F "),a(),n(25,"div",23),f(26,se,11,9,"div",24)(27,ue,8,6,"div",24)(28,ce,7,1,"div",24)(29,pe,7,1,"div",24),a()(),f(30,fe,6,1,"div",25),a()()()(),n(31,"div",26)(32,"button",27),y("click",function(){x(e);let l=d();return h(l.closeModal())}),u(33,"i",28),o(34," \u0417\u0430\u0442\u0432\u043E\u0440\u0438 "),a()()()()()}if(t&2){let e=d();m(6),g(" ",q(7,17,e.member.firstName,e.member.middleName,e.member.lastName)," "),m(7),s("ngIf",e.member.profileImageUrl),m(),s("ngIf",!e.member.profileImageUrl),m(2),_("bg-primary",e.member.gender==="Male")("bg-danger",e.member.gender==="Female"),m(),_("fa-mars",e.member.gender==="Male")("fa-venus",e.member.gender==="Female"),m(),g(" ",e.member.gender==="Male"?"\u041C\u044A\u0436":"\u0416\u0435\u043D\u0430"," "),m(8),s("ngIf",e.member.dateOfBirth&&e.canViewBirthDates),m(),s("ngIf",e.member.dateOfDeath),m(),s("ngIf",e.member.placeOfBirth),m(),s("ngIf",e.member.placeOfDeath),m(),s("ngIf",e.member.biography)}}function be(t,i){t&1&&u(0,"div",44)}var N=class t{member=null;canViewBirthDates=!1;close=new Y;ngOnInit(){this.member&&(document.body.style.overflow="hidden")}closeModal(){document.body.style.overflow="auto",this.close.emit()}onBackdropClick(i){this.closeModal()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-member-details-modal"]],inputs:{member:"member",canViewBirthDates:"canViewBirthDates"},outputs:{close:"close"},decls:2,vars:2,consts:[["class","modal fade show","style","display: block;","tabindex","-1",3,"click",4,"ngIf"],["class","modal-backdrop fade show",4,"ngIf"],["tabindex","-1",1,"modal","fade","show",2,"display","block",3,"click"],[1,"modal-dialog","modal-lg","modal-dialog-centered"],[1,"modal-content",3,"click"],[1,"modal-header"],[1,"modal-title"],[1,"fas","fa-user","me-2"],["type","button",1,"btn-close",3,"click"],[1,"modal-body"],[1,"row"],[1,"col-md-4","text-center","mb-4"],[1,"member-photo-large"],["class","member-image-large",3,"src","alt",4,"ngIf"],["class","member-avatar-large",3,"male-avatar","female-avatar",4,"ngIf"],[1,"mt-3"],[1,"badge"],[1,"fas","me-1"],[1,"col-md-8"],[1,"member-details"],[1,"detail-section","mb-4"],[1,"text-muted","mb-3"],[1,"fas","fa-info-circle","me-2"],[1,"row","g-3"],["class","col-12",4,"ngIf"],["class","detail-section",4,"ngIf"],[1,"modal-footer"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"fas","fa-times","me-2"],[1,"member-image-large",3,"src","alt"],[1,"member-avatar-large"],[1,"fas"],[1,"col-12"],[1,"detail-item"],[1,"fas","fa-birthday-cake","text-primary","me-2"],[1,"detail-label"],[1,"detail-value"],[1,"text-muted","ms-2"],[1,"fas","fa-cross","text-secondary","me-2"],[1,"fas","fa-map-marker-alt","text-success","me-2"],[1,"fas","fa-map-marker-alt","text-secondary","me-2"],[1,"detail-section"],[1,"fas","fa-book","me-2"],[1,"biography-text"],[1,"modal-backdrop","fade","show"]],template:function(e,r){e&1&&f(0,ge,35,21,"div",0)(1,be,1,0,"div",1),e&2&&(s("ngIf",r.member),m(),s("ngIf",r.member))},dependencies:[w,F,K,A,V],styles:[".member-photo-large[_ngcontent-%COMP%]{width:150px;height:150px;margin:0 auto;position:relative}.member-image-large[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:20px;object-fit:cover;border:3px solid rgba(255,255,255,.8);box-shadow:0 4px 15px #0003}.member-avatar-large[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:20px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:3rem;border:3px solid rgba(255,255,255,.8);box-shadow:0 4px 15px #0003;background:linear-gradient(45deg,#6c757d,#495057)}.male-avatar[_ngcontent-%COMP%]{background:linear-gradient(45deg,#007bff,#0056b3)!important}.female-avatar[_ngcontent-%COMP%]{background:linear-gradient(45deg,#e91e63,#ad1457)!important}.detail-section[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding-bottom:1rem}.detail-section[_ngcontent-%COMP%]:last-child{border-bottom:none;padding-bottom:0}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:.75rem;padding:.5rem;background:#f8f9fa;border-radius:.5rem}.detail-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.detail-label[_ngcontent-%COMP%]{font-weight:600;color:#495057;margin-right:.5rem;min-width:120px}.detail-value[_ngcontent-%COMP%]{color:#212529}.biography-text[_ngcontent-%COMP%]{background:#f8f9fa;padding:1rem;border-radius:.5rem;border-left:4px solid #007bff;line-height:1.6;color:#495057}.modal-content[_ngcontent-%COMP%]{border:none;border-radius:1rem;box-shadow:0 10px 30px #0000004d}.modal-header[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007bff,#0056b3);color:#fff;border-top-left-radius:1rem;border-top-right-radius:1rem;border-bottom:none}.modal-header[_ngcontent-%COMP%]   .btn-close[_ngcontent-%COMP%]{filter:invert(1) grayscale(100%) brightness(200%)}.modal-footer[_ngcontent-%COMP%]{border-top:1px solid #dee2e6;background:#f8f9fa;border-bottom-left-radius:1rem;border-bottom-right-radius:1rem}@media (max-width: 768px){.member-photo-large[_ngcontent-%COMP%]{width:120px;height:120px}.member-avatar-large[_ngcontent-%COMP%]{font-size:2.5rem}.detail-label[_ngcontent-%COMP%]{min-width:100px;font-size:.9rem}.detail-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;text-align:left}.detail-label[_ngcontent-%COMP%]{margin-bottom:.25rem;margin-right:0}}"]})};function _e(t,i){if(t&1&&u(0,"img",31),t&2){let e=d().$implicit;s("src",e.member1.profileImageUrl,O)("alt",e.member1.firstName+" "+e.member1.lastName)}}function ve(t,i){if(t&1&&(n(0,"div",32),u(1,"i",33),a()),t&2){let e=d().$implicit;m(),_("fa-mars",e.member1.gender==="Male")("fa-venus",e.member1.gender==="Female")}}function xe(t,i){if(t&1&&(n(0,"small",5),o(1),a()),t&2){let e=d().$implicit,r=d(3);m(),g(" ",r.getAge(e.member1.dateOfBirth)," \u0433\u043E\u0434. ")}}function he(t,i){t&1&&(n(0,"div",34),u(1,"div",35),n(2,"div",36),o(3,"\u2665"),a(),n(4,"div",37),o(5,"\u0436\u0435\u043D\u0435\u043D\u0438"),a()())}function ye(t,i){if(t&1&&u(0,"img",31),t&2){let e=d(2).$implicit;s("src",e.member2.profileImageUrl,O)("alt",e.member2.firstName+" "+e.member2.lastName)}}function Ce(t,i){if(t&1&&(n(0,"div",32),u(1,"i",33),a()),t&2){let e=d(2).$implicit;m(),_("fa-mars",e.member2.gender==="Male")("fa-venus",e.member2.gender==="Female")}}function Me(t,i){if(t&1&&(n(0,"small",5),o(1),a()),t&2){let e=d(2).$implicit,r=d(3);m(),g(" ",r.getAge(e.member2.dateOfBirth)," \u0433\u043E\u0434. ")}}function De(t,i){if(t&1){let e=M();n(0,"div",17),y("click",function(){x(e);let l=d().$implicit,c=d(3);return h(c.showMemberDetails(l.member2))}),n(1,"div",18),f(2,ye,1,2,"img",19)(3,Ce,2,4,"div",20),a(),n(4,"div",21)(5,"div",22),o(6),a(),n(7,"div",23),f(8,Me,2,1,"small",24),a()(),n(9,"div",25)(10,"div",26),u(11,"i",27),n(12,"small"),o(13,"\u041A\u043B\u0438\u043A\u043D\u0435\u0442\u0435"),a()()()()}if(t&2){let e=d().$implicit,r=d(3);_("male",e.member2.gender==="Male")("female",e.member2.gender==="Female"),R("title","\u041A\u043B\u0438\u043A\u043D\u0435\u0442\u0435 \u0437\u0430 \u043F\u043E\u0432\u0435\u0447\u0435 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u0437\u0430 "+e.member2.firstName+" "+e.member2.lastName),m(2),s("ngIf",e.member2.profileImageUrl),m(),s("ngIf",!e.member2.profileImageUrl),m(3),T("",e.member2.firstName," ",e.member2.lastName),m(2),s("ngIf",e.member2.dateOfBirth&&r.canViewBirthDates)}}function Ie(t,i){if(t&1&&(n(0,"div",38),u(1,"div",39),n(2,"div",40),u(3,"i",41),o(4),a(),n(5,"div",42),o(6),a()()),t&2){let e=d().$implicit,r=d(3);m(4),T(" ",e.children.length," ",e.children.length===1?"\u0434\u0435\u0442\u0435":"\u0434\u0435\u0446\u0430"," "),m(2),g(" ",r.getChildrenNames(e.children)," ")}}function Ee(t,i){if(t&1){let e=M();n(0,"div",15)(1,"div",16)(2,"div",17),y("click",function(){let l=x(e).$implicit,c=d(3);return h(c.showMemberDetails(l.member1))}),n(3,"div",18),f(4,_e,1,2,"img",19)(5,ve,2,4,"div",20),a(),n(6,"div",21)(7,"div",22),o(8),a(),n(9,"div",23),f(10,xe,2,1,"small",24),a()(),n(11,"div",25)(12,"div",26),u(13,"i",27),n(14,"small"),o(15,"\u041A\u043B\u0438\u043A\u043D\u0435\u0442\u0435"),a()()()(),f(16,he,6,0,"div",28)(17,De,14,10,"div",29),a(),f(18,Ie,7,3,"div",30),a()}if(t&2){let e=i.$implicit,r=d(3);m(2),_("male",e.member1.gender==="Male")("female",e.member1.gender==="Female"),R("title","\u041A\u043B\u0438\u043A\u043D\u0435\u0442\u0435 \u0437\u0430 \u043F\u043E\u0432\u0435\u0447\u0435 \u0438\u043D\u0444\u043E\u0440\u043C\u0430\u0446\u0438\u044F \u0437\u0430 "+e.member1.firstName+" "+e.member1.lastName),m(2),s("ngIf",e.member1.profileImageUrl),m(),s("ngIf",!e.member1.profileImageUrl),m(3),T("",e.member1.firstName," ",e.member1.lastName),m(2),s("ngIf",e.member1.dateOfBirth&&r.canViewBirthDates),m(6),s("ngIf",e.member2),m(),s("ngIf",e.member2),m(),s("ngIf",e.children.length>0)}}function Fe(t,i){if(t&1&&(n(0,"div",10)(1,"div",11)(2,"span",12),o(3),a()(),n(4,"div",13),f(5,Ee,19,13,"div",14),a()()),t&2){let e=i.$implicit,r=i.index,l=d(2);m(3),C(l.getGenerationLabel(r)),m(2),s("ngForOf",e)}}function we(t,i){if(t&1&&(n(0,"div",8),f(1,Fe,6,2,"div",9),a()),t&2){let e=d();m(),s("ngForOf",e.getSimplifiedTree())}}function Se(t,i){t&1&&(n(0,"div",43),u(1,"i",44),n(2,"h5",5),o(3,"\u041D\u044F\u043C\u0430 \u0434\u0430\u043D\u043D\u0438 \u0437\u0430 \u0441\u0435\u043C\u0435\u0439\u043D\u043E \u0434\u044A\u0440\u0432\u043E"),a(),n(4,"p",5),o(5,"\u0414\u043E\u0431\u0430\u0432\u0435\u0442\u0435 \u0440\u043E\u0434\u043D\u0438\u043D\u0441\u043A\u0438 \u0432\u0440\u044A\u0437\u043A\u0438 \u0437\u0430 \u0434\u0430 \u0441\u0435 \u043F\u043E\u043A\u0430\u0436\u0435 \u0434\u044A\u0440\u0432\u043E\u0442\u043E"),a()())}var $=class t{members=[];relationships=[];canViewBirthDates=!1;treeData=[];selectedMember=null;ngOnInit(){this.buildFamilyTree()}buildFamilyTree(){if(this.members.length===0){this.treeData=[];return}let i=this.relationships.filter(r=>r.relationshipType===1).map(r=>r.relatedMemberId),e=this.members.filter(r=>!i.includes(r.id));this.treeData=e.map(r=>this.buildNodeForMember(r,0))}buildNodeForMember(i,e){let r=this.getChildren(i.id),l=this.getSpouse(i.id);return{member:i,children:r.map(p=>this.buildNodeForMember(p,e+1)),level:e,spouse:l}}getChildren(i){return this.relationships.filter(r=>r.relationshipType===1&&r.primaryMemberId===i).map(r=>this.members.find(l=>l.id===r.relatedMemberId)).filter(r=>r!==void 0)}getSpouse(i){let e=this.relationships.find(r=>r.relationshipType===3&&(r.primaryMemberId===i||r.relatedMemberId===i));if(e){let r=e.primaryMemberId===i?e.relatedMemberId:e.primaryMemberId;return this.members.find(l=>l.id===r)}}getSimplifiedTree(){if(this.members.length===0||this.relationships.length===0)return[];let i=[],e=new Set,r=this.relationships.filter(c=>c.relationshipType===3),l=[];return r.forEach(c=>{let p=this.members.find(v=>v.id===c.primaryMemberId),b=this.members.find(v=>v.id===c.relatedMemberId);if(p&&b&&!e.has(p.id)&&!e.has(b.id)){let v=this.getChildrenOfCouple(p.id,b.id);l.push({member1:p,member2:b,children:v,generation:0}),e.add(p.id),e.add(b.id)}}),this.members.forEach(c=>{if(!e.has(c.id)){let p=this.getChildren(c.id);p.length>0&&(l.push({member1:c,member2:void 0,children:p,generation:0}),e.add(c.id))}}),l.length===0&&this.members.forEach(c=>{e.has(c.id)||l.push({member1:c,member2:void 0,children:this.getChildren(c.id),generation:0})}),l.length>0&&i.push(l),i}getChildrenOfCouple(i,e){let r=this.getChildren(i),l=this.getChildren(e);return r.filter(p=>l.some(b=>b.id===p.id))}getGenerationLabel(i){return["\u041E\u0441\u043D\u043E\u0432\u0430\u0442\u0435\u043B\u0438","\u041F\u044A\u0440\u0432\u043E \u043F\u043E\u043A\u043E\u043B\u0435\u043D\u0438\u0435","\u0412\u0442\u043E\u0440\u043E \u043F\u043E\u043A\u043E\u043B\u0435\u043D\u0438\u0435","\u0422\u0440\u0435\u0442\u043E \u043F\u043E\u043A\u043E\u043B\u0435\u043D\u0438\u0435","\u0427\u0435\u0442\u0432\u044A\u0440\u0442\u043E \u043F\u043E\u043A\u043E\u043B\u0435\u043D\u0438\u0435"][i]||`${i+1}-\u0442\u043E \u043F\u043E\u043A\u043E\u043B\u0435\u043D\u0438\u0435`}getAge(i){let e=new Date,r=new Date(i),l=e.getFullYear()-r.getFullYear(),c=e.getMonth()-r.getMonth();return(c<0||c===0&&e.getDate()<r.getDate())&&l--,l}getChildrenLineWidth(i){return Math.max(100,i*50)}getChildrenNames(i){return!i||i.length===0?"":i.map(e=>`${e.firstName} ${e.lastName}`).join(", ")}showMemberDetails(i){this.selectedMember=i}closeMemberDetails(){this.selectedMember=null}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=E({type:t,selectors:[["app-family-tree"]],inputs:{members:"members",relationships:"relationships",canViewBirthDates:"canViewBirthDates"},decls:11,vars:4,consts:[["noTreeData",""],[1,"family-tree-container"],[1,"tree-header","text-center","mb-4"],[1,"text-primary"],[1,"fas","fa-sitemap","me-2"],[1,"text-muted"],["class","tree-content",4,"ngIf","ngIfElse"],[3,"close","member","canViewBirthDates"],[1,"tree-content"],["class","generation-container mb-5",4,"ngFor","ngForOf"],[1,"generation-container","mb-5"],[1,"text-center","mb-4"],[1,"badge","bg-primary","generation-badge"],[1,"couples-container","d-flex","justify-content-center","flex-wrap","gap-4","mb-4"],["class","couple-unit",4,"ngFor","ngForOf"],[1,"couple-unit"],[1,"couple-display","d-flex","align-items-center","gap-3"],[1,"tree-node","clickable",3,"click"],[1,"member-photo"],["class","member-image",3,"src","alt",4,"ngIf"],["class","member-avatar",4,"ngIf"],[1,"member-info"],[1,"member-name"],[1,"member-details"],["class","text-muted",4,"ngIf"],[1,"member-actions"],[1,"action-hint"],[1,"fas","fa-mouse-pointer"],["class","marriage-connection",4,"ngIf"],["class","tree-node clickable",3,"male","female","click",4,"ngIf"],["class","children-indicator text-center mt-3",4,"ngIf"],[1,"member-image",3,"src","alt"],[1,"member-avatar"],[1,"fas"],[1,"marriage-connection"],[1,"marriage-line"],[1,"marriage-symbol"],[1,"marriage-label"],[1,"children-indicator","text-center","mt-3"],[1,"children-line"],[1,"children-count","badge","bg-success"],[1,"fas","fa-baby","me-1"],[1,"children-names","text-muted","small","mt-1"],[1,"no-tree-data","text-center","py-5"],[1,"fas","fa-sitemap","fa-4x","text-muted","mb-3"]],template:function(e,r){if(e&1){let l=M();n(0,"div",1)(1,"div",2)(2,"h4",3),u(3,"i",4),o(4," \u0421\u0435\u043C\u0435\u0439\u043D\u043E \u0434\u044A\u0440\u0432\u043E "),a(),n(5,"p",5),o(6,"\u0418\u043D\u0442\u0435\u0440\u0430\u043A\u0442\u0438\u0432\u043D\u0430 \u0432\u0438\u0437\u0443\u0430\u043B\u0438\u0437\u0430\u0446\u0438\u044F \u043D\u0430 \u0441\u0435\u043C\u0435\u0439\u043D\u0438\u0442\u0435 \u0432\u0440\u044A\u0437\u043A\u0438"),a()(),f(7,we,2,1,"div",6)(8,Se,6,0,"ng-template",null,0,H),a(),n(10,"app-member-details-modal",7),y("close",function(){return x(l),h(r.closeMemberDetails())}),a()}if(e&2){let l=G(9);m(7),s("ngIf",r.getSimplifiedTree().length>0)("ngIfElse",l),m(3),s("member",r.selectedMember)("canViewBirthDates",r.canViewBirthDates)}},dependencies:[w,J,F,N],styles:[".family-tree-container[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);border-radius:1rem;padding:2rem;border:1px solid #dee2e6}.generation-container[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;padding:2rem;box-shadow:0 4px 6px #0000001a;border:1px solid #e9ecef}.generation-badge[_ngcontent-%COMP%]{font-size:1rem;padding:.75rem 1.5rem;border-radius:2rem;font-weight:600}.couples-container[_ngcontent-%COMP%]{min-height:200px}.couple-unit[_ngcontent-%COMP%]{background:#f8f9fa;border-radius:1rem;padding:1.5rem;border:2px solid #e9ecef;min-width:300px}.couple-display[_ngcontent-%COMP%]{justify-content:center}.tree-node[_ngcontent-%COMP%]{background:#fff;border:2px solid #e9ecef;border-radius:1rem;padding:1rem;width:180px;box-shadow:0 4px 6px #0000001a;transition:all .3s ease}.tree-node[_ngcontent-%COMP%]:hover{transform:translateY(-3px);box-shadow:0 6px 15px #00000026}.tree-node.clickable[_ngcontent-%COMP%]{cursor:pointer;-webkit-user-select:none;user-select:none}.tree-node.clickable[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 20px #0003}.tree-node.clickable[_ngcontent-%COMP%]:active{transform:translateY(-2px);box-shadow:0 4px 10px #0003}.tree-node.male[_ngcontent-%COMP%]{border-color:#007bff;background:linear-gradient(135deg,#fff,#e3f2fd)}.tree-node.female[_ngcontent-%COMP%]{border-color:#e91e63;background:linear-gradient(135deg,#fff,#fce4ec)}.member-photo[_ngcontent-%COMP%]{width:70px;height:70px;margin:0 auto .75rem;position:relative}.member-image[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:12px;object-fit:cover;border:2px solid rgba(255,255,255,.8);box-shadow:0 2px 8px #00000026}.member-avatar[_ngcontent-%COMP%]{width:70px;height:70px;border-radius:12px;background:linear-gradient(45deg,#6c757d,#495057);display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.8rem;border:2px solid rgba(255,255,255,.8);box-shadow:0 2px 8px #00000026}.tree-node.male[_ngcontent-%COMP%]   .member-avatar[_ngcontent-%COMP%]{background:linear-gradient(45deg,#007bff,#0056b3)}.tree-node.female[_ngcontent-%COMP%]   .member-avatar[_ngcontent-%COMP%]{background:linear-gradient(45deg,#e91e63,#ad1457)}.member-info[_ngcontent-%COMP%]{text-align:center;margin-bottom:.75rem}.member-name[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem;color:#333;line-height:1.2}.member-details[_ngcontent-%COMP%]{margin-top:.25rem}.member-actions[_ngcontent-%COMP%]{text-align:center}.action-hint[_ngcontent-%COMP%]{color:#6c757d;font-size:.7rem;opacity:.8;transition:opacity .3s ease}.tree-node.clickable[_ngcontent-%COMP%]:hover   .action-hint[_ngcontent-%COMP%]{opacity:1;color:#007bff}.marriage-connection[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;margin:0 1rem}.marriage-line[_ngcontent-%COMP%]{width:3px;height:40px;background:linear-gradient(to bottom,#e91e63,#ff6b9d);border-radius:2px}.marriage-symbol[_ngcontent-%COMP%]{color:#e91e63;font-size:1.5rem;font-weight:700;margin:.25rem 0;text-shadow:0 1px 3px rgba(0,0,0,.2)}.marriage-label[_ngcontent-%COMP%]{font-size:.7rem;color:#6c757d;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.children-indicator[_ngcontent-%COMP%]{border-top:2px solid #28a745;padding-top:1rem;margin-top:1rem}.children-line[_ngcontent-%COMP%]{width:2px;height:20px;background:#28a745;margin:0 auto .5rem}.children-count[_ngcontent-%COMP%]{font-size:.8rem;padding:.5rem 1rem;border-radius:2rem;display:inline-block}.children-names[_ngcontent-%COMP%]{margin-top:.5rem;font-style:italic;max-width:250px;margin-left:auto;margin-right:auto}.no-tree-data[_ngcontent-%COMP%]{background:#fff;border-radius:1rem;border:2px dashed #dee2e6;margin:2rem 0}@media (max-width: 768px){.family-tree-container[_ngcontent-%COMP%], .generation-container[_ngcontent-%COMP%]{padding:1rem}.couple-unit[_ngcontent-%COMP%]{min-width:280px;padding:1rem}.tree-node[_ngcontent-%COMP%]{width:140px;padding:.75rem}.member-name[_ngcontent-%COMP%]{font-size:.8rem}.couple-display[_ngcontent-%COMP%]{flex-direction:column;gap:1rem}.marriage-connection[_ngcontent-%COMP%]{margin:.5rem 0}.marriage-line[_ngcontent-%COMP%]{height:20px;width:40px}}"]})};var Oe=t=>["/families",t,"members","create"];function Pe(t,i){t&1&&(n(0,"div",4)(1,"div",5)(2,"span",6),o(3,"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435..."),a()(),n(4,"p",7),o(5,"\u0417\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435 \u043D\u0430 \u0441\u0435\u043C\u0435\u0439\u0441\u0442\u0432\u043E..."),a()())}function Te(t,i){if(t&1){let e=M();n(0,"div",8),u(1,"i",9),n(2,"h4"),o(3,"\u0412\u044A\u0437\u043D\u0438\u043A\u043D\u0430 \u0433\u0440\u0435\u0448\u043A\u0430"),a(),n(4,"p",10),o(5),a(),n(6,"button",11),y("click",function(){x(e);let l=d();return h(l.loadFamily())}),u(7,"i",12),o(8," \u041E\u043F\u0438\u0442\u0430\u0439\u0442\u0435 \u043E\u0442\u043D\u043E\u0432\u043E "),a()()}if(t&2){let e=d();m(5),C(e.error)}}function ke(t,i){if(t&1&&(n(0,"p",33),o(1),a()),t&2){let e=d(2);m(),g(" ",e.family.description," ")}}function Ae(t,i){if(t&1&&(n(0,"div",27)(1,"div",28),u(2,"i",34),n(3,"span"),o(4),a()()()),t&2){let e=d(2);m(4),C(e.family.location)}}function Be(t,i){if(t&1&&(n(0,"div",35),u(1,"app-family-tree",36),a()),t&2){let e=d(2);m(),s("members",e.members)("relationships",e.relationships)("canViewBirthDates",e.canViewPersonalData())}}function Ve(t,i){if(t&1&&(n(0,"a",40),u(1,"i",41),o(2," \u0414\u043E\u0431\u0430\u0432\u0438 \u043F\u044A\u0440\u0432\u0438\u044F \u0447\u043B\u0435\u043D "),a()),t&2){let e=d(3);s("routerLink",W(1,Oe,e.family.id))}}function Ne(t,i){if(t&1&&(n(0,"div",4),u(1,"i",37),n(2,"h4",7),o(3,"\u041D\u044F\u043C\u0430 \u0434\u043E\u0431\u0430\u0432\u0435\u043D\u0438 \u0447\u043B\u0435\u043D\u043E\u0432\u0435"),a(),n(4,"p",38),o(5,"\u0414\u043E\u0431\u0430\u0432\u0435\u0442\u0435 \u043F\u044A\u0440\u0432\u0438\u044F \u0447\u043B\u0435\u043D \u043A\u044A\u043C \u0442\u043E\u0432\u0430 \u0441\u0435\u043C\u0435\u0439\u0441\u0442\u0432\u043E"),a(),f(6,Ve,3,3,"a",39),a()),t&2){let e=d(2);m(6),s("ngIf",e.canManageFamily())}}function $e(t,i){if(t&1&&(n(0,"div")(1,"div",13)(2,"a",14),u(3,"i",15),o(4," \u041E\u0431\u0440\u0430\u0442\u043D\u043E \u043A\u044A\u043C \u043A\u0430\u0442\u0430\u043B\u043E\u0433\u0430 "),a()(),n(5,"div",16)(6,"div",17)(7,"div",18)(8,"div")(9,"h3",19),u(10,"i",20),o(11),a(),n(12,"small",21),u(13,"i",22),o(14),I(15,"relativeDate"),a()()()(),n(16,"div",23),f(17,ke,2,1,"p",24),n(18,"div",25),f(19,Ae,5,1,"div",26),n(20,"div",27)(21,"div",28),u(22,"i",29),n(23,"span"),o(24),a()()(),n(25,"div",27)(26,"span",30),u(27,"i",31),o(28),a()()()()(),f(29,Be,2,3,"div",32)(30,Ne,7,1,"div",1),a()),t&2){let e=d();m(11),g(" ",e.family.name," "),m(3),g(" \u0421\u044A\u0437\u0434\u0430\u0434\u0435\u043D\u043E ",k(15,16,e.family.createdAt)," "),m(3),s("ngIf",e.family.description),m(2),s("ngIf",e.family.location),m(5),g("",e.members.length," \u0447\u043B\u0435\u043D\u043E\u0432\u0435"),m(2),_("bg-success",e.family.isPublic)("bg-secondary",!e.family.isPublic),m(),_("fa-globe",e.family.isPublic)("fa-lock",!e.family.isPublic),m(),g(" ",e.family.isPublic?"\u041F\u0443\u0431\u043B\u0438\u0447\u043D\u043E":"\u0427\u0430\u0441\u0442\u043D\u043E"," "),m(),s("ngIf",e.members.length>0),m(),s("ngIf",e.members.length===0)}}var oe=class t{constructor(i,e,r,l,c,p){this.route=i;this.router=e;this.familyService=r;this.memberService=l;this.relationshipService=c;this.authService=p}destroy$=new z;family=null;members=[];relationships=[];isLoading=!0;error=null;familyId=0;ngOnInit(){this.route.params.pipe(S(this.destroy$)).subscribe(i=>{this.familyId=+i.id,this.familyId?this.loadFamily():(this.error="\u041D\u0435\u0432\u0430\u043B\u0438\u0434\u0435\u043D \u0438\u0434\u0435\u043D\u0442\u0438\u0444\u0438\u043A\u0430\u0442\u043E\u0440 \u043D\u0430 \u0441\u0435\u043C\u0435\u0439\u0441\u0442\u0432\u043E",this.isLoading=!1)})}ngAfterViewInit(){setTimeout(()=>{this.familyId&&this.loadMembers()},500)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}loadFamily(){this.isLoading=!0,this.error=null,this.familyService.getFamilyById(this.familyId).pipe(S(this.destroy$)).subscribe({next:i=>{this.family=i,this.loadMembers()},error:i=>{this.isLoading=!1,this.error="\u0421\u0435\u043C\u0435\u0439\u0441\u0442\u0432\u043E\u0442\u043E \u043D\u0435 \u0435 \u043D\u0430\u043C\u0435\u0440\u0435\u043D\u043E \u0438\u043B\u0438 \u0432\u044A\u0437\u043D\u0438\u043A\u043D\u0430 \u0433\u0440\u0435\u0448\u043A\u0430 \u043F\u0440\u0438 \u0437\u0430\u0440\u0435\u0436\u0434\u0430\u043D\u0435\u0442\u043E.",console.error("Error loading family:",i)}})}loadMembers(){this.memberService.getMembersByFamily(this.familyId).pipe(S(this.destroy$)).subscribe({next:i=>{this.members=i,this.loadRelationships()},error:i=>{this.members=[],this.isLoading=!1,console.error("Error loading members:",i)}})}loadRelationships(){this.relationshipService.getRelationshipsByFamily(this.familyId).pipe(S(this.destroy$)).subscribe({next:i=>{this.relationships=i,this.isLoading=!1},error:i=>{this.relationships=[],this.isLoading=!1,console.error("Error loading relationships:",i)}})}refreshMembers(){this.loadMembers()}canManageFamily(){return this.family?this.authService.getCurrentUser()?.id===this.family.createdByUserId:!1}canViewPersonalData(){return this.canManageFamily()}static \u0275fac=function(e){return new(e||t)(D(Q),D(X),D(ie),D(ne),D(re),D(ee))};static \u0275cmp=E({type:t,selectors:[["app-family-details"]],decls:4,vars:3,consts:[[1,"container","my-4"],["class","text-center py-5",4,"ngIf"],["class","alert alert-danger text-center","role","alert",4,"ngIf"],[4,"ngIf"],[1,"text-center","py-5"],["role","status",1,"spinner-border","text-primary","mb-3"],[1,"visually-hidden"],[1,"text-muted"],["role","alert",1,"alert","alert-danger","text-center"],[1,"fas","fa-exclamation-triangle","fa-2x","mb-3"],[1,"mb-3"],[1,"btn","btn-primary",3,"click"],[1,"fas","fa-redo","me-2"],[1,"mb-4"],["routerLink","/families",1,"btn","btn-outline-secondary"],[1,"fas","fa-arrow-left","me-2"],[1,"card","shadow-sm","mb-4"],[1,"card-header","bg-primary","text-white"],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],[1,"fas","fa-home","me-2"],[1,"opacity-75"],[1,"fas","fa-calendar","me-1"],[1,"card-body"],["class","lead mb-4",4,"ngIf"],[1,"row","g-3"],["class","col-md-4",4,"ngIf"],[1,"col-md-4"],[1,"d-flex","align-items-center","text-muted"],[1,"fas","fa-users","me-2"],[1,"badge"],[1,"me-1"],["class","mb-5",4,"ngIf"],[1,"lead","mb-4"],[1,"fas","fa-map-marker-alt","me-2"],[1,"mb-5"],[3,"members","relationships","canViewBirthDates"],[1,"fas","fa-user-plus","fa-4x","text-muted","mb-3"],[1,"text-muted","mb-4"],["class","btn btn-primary",3,"routerLink",4,"ngIf"],[1,"btn","btn-primary",3,"routerLink"],[1,"fas","fa-plus","me-2"]],template:function(e,r){e&1&&(n(0,"div",0),f(1,Pe,6,0,"div",1)(2,Te,9,1,"div",2)(3,$e,31,18,"div",3),a()),e&2&&(m(),s("ngIf",r.isLoading),m(),s("ngIf",r.error),m(),s("ngIf",r.family&&!r.isLoading&&!r.error))},dependencies:[w,F,Z,$,te],encapsulation:2})};export{oe as FamilyDetailsComponent};
